{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios'\n\nexport const PAGE_SIZE = 15;\n\naxios.defaults.baseURL = 'https://pixabay.com'\n\nexport async function getImagesByQuery(query, currentPage) {\n\n  const res = await axios.get('/api/', {\n    params: {\n      key: '50436356-4cb7de4c874e77a26622e7211',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: PAGE_SIZE,\n      page: currentPage,\n    }\n  })\n  return res.data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nexport const refs = {\n  galleryList: document.querySelector(\".gallery\"),\n  loaderSubmitElem: document.querySelector(\".js-loader-submit\"),\n  loaderMoreElem: document.querySelector('.js-loader-more'),\n  formElem: document.querySelector(\".form\"),\n  loadBtnElem: document.querySelector(\".load-btn\"),\n}\n\n\n\nconst lightbox = new SimpleLightbox('.gallery-item .gallery-link', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\n\nexport function createGallery(images) {\n\n  const markup = renderCards(images)\n  refs.galleryList.insertAdjacentHTML(\"beforeend\", markup)\n  lightbox.refresh()\n\n}\n\nfunction renderCard(obj) {\n  const { webformatURL, largeImageURL, tags, likes, views, comments, downloads } = obj\n  const alt = tags.split(\",\").slice(0, 4).join(',')\n\n  return `<li class=\"gallery-item\"><a class=\"gallery-link\" href=\"${largeImageURL}\"><img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${alt}\">\n        <ul class=\"text-list\">\n          <li class=\"text-item\">\n            <h3  class=\"subtitle\">Likes</h3>\n            <p  class=\"text\">${likes}</p>\n          </li>\n          <li  class=\"text-item\">\n            <h3  class=\"subtitle\">Views</h3>\n            <p  class=\"text\">${views}</p>\n          </li>\n          <li  class=\"text-item\">\n            <h3  class=\"subtitle\">Comments</h3>\n            <p  class=\"text\">${comments}</p>\n          </li>\n          <li  class=\"text-item\">\n            <h3  class=\"subtitle\">Download</h3>\n            <p  class=\"text\">${downloads}</p>\n          </li>\n        </ul>\n      </a></li>`\n}\n\nfunction renderCards(arr) {\n  return arr.map(renderCard).join('\\n\\n\\n')\n}\n\n\n\nexport function clearGallery() {\n  refs.galleryList.innerHTML = '';\n}\n\nexport function showLoader() {\n  refs.loaderSubmitElem.classList.remove('hidden');\n}\n\nexport function hideLoader() {\n  refs.loaderSubmitElem.classList.add('hidden');\n}\n\nexport function showLoadMoreButton() {\n  refs.loadBtnElem.classList.remove('hidden');\n}\nexport function hideLoadMoreButton() {\n  refs.loadBtnElem.classList.add('hidden');\n}\n\nexport function showLoaderMore() {\n\n  refs.loaderMoreElem.classList.remove('hidden');\n}\nexport function hideLoaderMore() {\n\n  refs.loaderMoreElem.classList.add('hidden');\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport { getImagesByQuery, PAGE_SIZE } from \"./js/pixabay-api\";\nimport { refs, createGallery, clearGallery, hideLoader, showLoader, showLoadMoreButton, hideLoadMoreButton, showLoaderMore, hideLoaderMore } from \"./js/render-functions\";\n\nlet userData;\nlet currentPage = 1;\nlet maxPage = 0;\n\n\nrefs.formElem.addEventListener(\"submit\", handlerFormClick)\nrefs.loadBtnElem.addEventListener(\"click\", handlerLoadMoreClick)\n\n\nasync function handlerFormClick(e) {\n  e.preventDefault();\n\n  userData = e.target.elements['search-text'].value.trim().toLowerCase()\n  currentPage = 1;\n\n  if (userData === '') {\n    notification();\n    return;\n  }\n\n  clearGallery();\n  showLoader();\n  hideLoadMoreButton();\n\n  const res = await getImagesByQuery(userData, currentPage)\n\n  if (res.hits) {\n    hideLoader();\n    createGallery(res.hits);\n  }\n\n  maxPage = Math.ceil(res.totalHits / PAGE_SIZE)\n  notification();\n  loadBtnStatus();\n\n  e.target.reset();\n};\n\n\nasync function handlerLoadMoreClick(e) {\n  currentPage++\n\n  showLoaderMore();\n\n  const res = await getImagesByQuery(userData, currentPage);\n\n  if (res.hits) {\n    hideLoaderMore();\n    loadBtnStatus();\n    notification();\n\n    createGallery(res.hits)\n    BoundingClientRect();\n  }\n\n}\n\n\nfunction loadBtnStatus() {\n  if (currentPage < maxPage) {\n    showLoadMoreButton();\n  } else {\n    hideLoadMoreButton();\n  }\n}\n\nfunction notification() {\n  if (userData === '') {\n    iziToast.warning({\n      message: 'The search field is empty. Please enter a keyword.',\n      position: 'topRight'\n    });\n    return\n  };\n\n  if (currentPage === maxPage) {\n    iziToast.warning({\n      message: \"We're sorry, but you've reached the end of search results\",\n      position: \"topRight\"\n    })\n  };\n\n  if (maxPage === 0) {\n    iziToast.error({\n      message: \"Nothing was found for your request!\",\n      position: \"topRight\"\n    })\n  }\n}\n\n\nfunction BoundingClientRect() {\n  const cardElem = document.querySelector(\".gallery-item\");\n  if (cardElem) {\n    const rect = cardElem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: rect * 2,\n      behavior: 'smooth',\n    })\n  }\n}\n\n\n\n\n\n"],"names":["PAGE_SIZE","axios","getImagesByQuery","query","currentPage","refs","lightbox","SimpleLightbox","createGallery","images","markup","renderCards","renderCard","obj","webformatURL","largeImageURL","tags","likes","views","comments","downloads","alt","arr","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","showLoaderMore","hideLoaderMore","userData","maxPage","handlerFormClick","handlerLoadMoreClick","e","notification","res","loadBtnStatus","BoundingClientRect","iziToast","cardElem","rect"],"mappings":"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"}